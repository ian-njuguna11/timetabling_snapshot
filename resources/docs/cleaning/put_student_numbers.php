foreach($rowData as $key=>$row){if($key == count($rowData) - 1)continue;$program_data = new stdClass();$program_data->program_code = $row[0];$program_data->sem1 = (int) $row[4];$program_data->sem2 = ((int) $row[6]) + ((int) $row[8]);$program_data->sem3 = ((int) $row[11]) + ((int) $row[12]);$program_data->sem4 = ((int) $row[13]) + ((int) $row[14]);$program_data->sem5 = ((int) $row[17]) + ((int) $row[18]);$program_data->sem6 = ((int) $row[19]) + ((int) $row[20]);$program_data->sem7 = ((int) $row[23]) + ((int) $row[24]);$program_data->sem8 = ((int) $row[25]) + ((int) $row[26]);$nums_collection->push($program_data);}

Program::with('levels')->get()->each(function($program) use ($nums_collection){$program_data = $nums_collection->where('program_code', $program->program_code)->first();if($program_data){foreach($program->levels as $level){$sem_number = "sem".$level->semester_number;$level->num_students = $program_data->$sem_number;$level->save();}}});
